# 深度学习系列——RNN循环神经网络

## 什么是RNN？

RNN的输出取决于前一时间的输入和当下的隐变量

$$
\begin{CD}
    o_1 @. o_2\\
    @A W_{ho} AA  @A W_{ho} AA\\
    h_1 @>W_{hh}>> h_2 \\
    @. W_{hx}/  @. \\
    x_1 @. x_2 \\
\end{CD}
$$

更新隐藏状态：$h_t = f(W_{hh}h_{t-1}+W_{hx}x_{t-1}+b_h)$
输出：o_t = f(W_{h0}h_t+b_o)

应用到语言模型中时，循环神经网络根据当前词预测下一时刻的词

## 困惑度（perplexity）

NLP中通常使用困惑度来衡量语言模型的好坏

衡量一个语言模型的好坏可以用平均交叉熵

$$\pi = \frac{1}{n}\sum^n_{i=1}-logp(x_t|x_{t-1},...)$$

p 是语言模型的预测概率，$x_t$是真实词

历史原因NLP使用困惑度$exp(\pi)$来衡量，是平均每次可能选项  
1表示完美，无穷大是最差的情况

## 梯度裁剪

迭代中计算这T个时间步上的梯度，在反向传播过程中产生长度为O(T)的矩阵乘法链，导致数值不稳定
梯度裁剪能有效预防梯度爆炸
如果梯度长度超过$\theta$，那么投影回长度$\theta$
$$min(1,\frac{\theta}{||g||})g \to g$$